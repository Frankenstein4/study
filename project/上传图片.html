<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    <input type="file" name="" id="">
    <script src="jquery.min.js"></script>
    <script>
    $("input[type='file']").change(function(){   
             var file = this.files[0];
          //   if(file.length>0){
                var name = file.name;//读取选中文件的文件名
                var size = file.size;//读取选中文件的大小
                var type = file.type;//读取选中文件的大小
                var extensionName = file.name.split('.');// 获取扩展名
              //  alert(extensionName);
                extensionName = extensionName[extensionName.length -1];
              //  alert(extensionName);
                if(extensionName=="png"){
                    alert("不允许png类型的图片上传！");
                    return;
                }
                //判断是否是图片类型
                if(!/image\/\w+/.test(type)){ 
                    alert("只能选择图片");
                    return false;
                }
                
                if ( typeof(FileReader) === 'undefined' ){ 
                    alert( "抱歉，你的浏览器不支持 FileReader，请使用现代浏览器操作！");
                    return;
                }

                //使用方法,传入一个blob数据,在回调中接收处理成功的图片url
                fileToBase64Code(file, function(data) {
                    var base64code = data; //base64数据 
                 //   document.getElementById("file_img").src = base64code;
                    uploadimage(name,base64code);
                    
                });
                /*
                 if (window.FileReader) {    
                        var reader = new FileReader();    
                        reader.readAsDataURL(file); 
                        reader.onloadend = function (e) {
                            console.log(this.result);
                            convertImgToBase64(e.target.result, function(base64Img){ 
                                console.log(base64Img); 
                                aa(base64Img);
                            });
                            aa(this.result);
                            
                        };    
                 }*/
           //  }
        });
    
        function fileToBase64Code(file,callback){
            var reader = new FileReader();
            reader.onload = function(e) {
                callback(e.target.result);
            }
            reader.readAsDataURL(file);
        }
    </script>
</body>
</html>