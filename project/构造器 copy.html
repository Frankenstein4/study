<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>构造器</title>
    <style>
            .on{ background: #f60; color: #fff}
            .box div{
                width:200px;
                height:200px;
                border: 1px solid #000;
                display: none;
            }
            *{
                margin: 0;
                padding: 0;
            }
            .box{
                width: 200px;
                height: 200px;
                margin-top: 50px
            }
        </style>
</head>
    
    <script>


Function.prototype.bind1=function (context) {
    if(typeof this !=='function'){
        throw new Error(`${this.name} is not a function`)
    }
    const srcFun=this// 保存原始函数
    const arg=Array.prototype.slice.call(arguments,1)// 把arguments类数组转为真实数组
    let noop=function(){}
    const fBound= function () {
    if(this instanceof noop){
        context=this
    }
        // 合并新旧参数
        return srcFun.apply(context,arg.concat(Array.prototype.slice.call(arguments,0)))
    }
    if(this.prototype){
        noop.prototype=this.prototype//维护原型关系，指向原始函数
    }
    fBound.prototype=new noop()//新函数的prototype的__proto__指向noop.prototype
    return fBound
    }




    Function.prototype.my_bind = function() {
      var self = this, // 保存原函数
        context = Array.prototype.shift.call(arguments), // 保存需要绑定的this上下文
        // 上一行等价于 context = [].shift.call(arguments);
        args = Array.prototype.slice.call(arguments); // 剩余的参数转为数组
      return function() { // 返回一个新函数
        self.apply(context, Array.prototype.concat.call(args, Array.prototype.slice.call(arguments)));
      }
    }



        Function.prototype.bind2 = function (context) {

            if (typeof this !== "function") {
            throw new Error("Function.prototype.bind - what is trying to be bound is not callable");
            }

            var self = this;
            var args = Array.prototype.slice.call(arguments, 1);
            var fNOP = function () {};

            var fbound = function () {
                self.apply(this instanceof self ? this : context, args.concat(Array.prototype.slice.call(arguments)));
            }

            fNOP.prototype = this.prototype;
            fbound.prototype = new fNOP();

            return fbound;

            }



        //选项卡
        class Tab{
            constructor(id){
                this.oBox=document.getElementById(id);
                this.aBtn=this.oBox.getElementsByTagName('input');
                this.aDiv=this.oBox.getElementsByTagName('div');
                this.init();
            }
            init(){
                for(let i=0; i<this.aBtn.length; i++){
                    this.aBtn[i].onclick=function(){
                        this.iNow=i;
                        this.hide();
                        this.show(i);
                    }.bind(this);//重新绑定this的指向  指向tab
                }
            }
            hide(){
                for(let i=0; i<this.aBtn.length; i++){
                    this.aBtn[i].className='';
                    this.aDiv[i].style.display='none';
                }
            }
            show(index){
                this.aBtn[index].className='on';
                this.aDiv[index].style.display='block';
            }
        }
        //继承
        class AutoTab extends Tab{//第二要用，则继承前一个就好
            constructor(id){
                super(id);
                this.aBtn1=document.getElementsByClassName('div2');
                this.aDiv1=document.getElementById('box2');
                // super.init();
                this.auto();
            }
           
            ff2(){
                super.hide()
            }
            ff3(){
                super.show()
            }
            auto(){
                for(let i=0; i<this.aBtn1.length; i++){
                    this.aBtn1[i].onclick=function(){
                        this.color(i);
                    }.bind(this);//重新绑定this的指向  指向tab???还是AutoTab??
                }
            }
            color(i){
                this.aDiv1.style.background="#8bde4f";
                this.aDiv1.style.color="red";
                
            }
        }


        window.onload=function(){
            new Tab('box');
            new AutoTab('box2');
        };
    </script>
</head>
<body>
    <div id="box" class="box">
        <input class="on" type="button" value="aaa">
        <input type="button" value="bbb">
        <input type="button" value="ccc">
        <div style="display: block;">1111</div>
        <div>2222</div>
        <div>3333</div>
    </div>
    <div id="box2" class="box">
        <input class="on div2" type="button" value="aaa">
        <input type="button" value="bbb" class="div2">
        <input type="button" value="ccc" class="div2">
        <div style="display: block;">1111</div>
        <div>2222</div>
        <div>3333</div>
    </div>
</body>
</html>
